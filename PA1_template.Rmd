---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

## Assignment Info
* Filename: PA1_template.Rmd
* Name: Walter Yu
* Date: July 2020

### Introduction 

This markdown file is an analysis and visualization of UCI human activity recognition dataset. Source data for this assignment is an aggregated dataset from the original available [here][1].

[1]: https://archive.ics.uci.edu/ml/datasets/human+activity+recognition+using+smartphones

This assignment is completed for the JHU Coursera Data Science Program, which is a 10 course certification. More info about this program is available [here][2].

[2]: https://www.coursera.org/specializations/jhu-data-science

### Notes
1. All code included to show data import and plot
2. Full dataset was imported, then subset for plot
3. Plotting systems used per assignment instructions 

## Loading and preprocessing the data

### Part 1: Import data per assignment instructions

Processing Steps:
* Data was loaded with read.csv function per instructions
* File was unzipped, then read into program

Analysis:
* Head, names and summary functions were used to review the data
* Data has null values (2308 rows) and median steps of zero

### Part 2: Remove null values

Processing Steps:
* The na.omit function was used to remove null values
* Results were assigned to a new variable

Analysis:
* Head, names and summary functions were used to review the data
* Data has null values (2308 rows) and median steps of zero
* Summary function indicates mean/median steps did not change

```{r echo=TRUE}

setwd("C:/Users/kharm/Documents/src_dsci/jhu_coursera/05_research/RepData_PeerAssessment1")

# part 1: import data per assignment instructions
# source: assignment instructions
activity <- read.csv("activity.csv")

# review dataset
# https://www.statmethods.net/stats/descriptives.html
head(activity)
names(activity)
summary(activity)

# part 2: remove null values
# source: https://www.statmethods.net/input/missingdata.html
activity_omit <- na.omit(activity)

# verify results
# https://www.statmethods.net/stats/descriptives.html
head(activity_omit)
names(activity_omit)
summary(activity_omit)

```

## What is mean total number of steps taken per day?

### Part 1: Calculate sum, then create histogram 

Processing Steps:
* The aggreage function was used to calculate total steps/day
* Results were assigned to a new variable

Analysis:
* Head, names and summary functions were used to review the data
* Verified that aggregate returned total steps per day

Plot:
* Histogram was created for steps/day; axis adjusted to fit data
* Bins were applied to visualize the data effectively

### Part 2: Calculate mean/median by date

Processing Steps:
* The aggreage function was used to calculate total steps/day
* Results were assigned to a new variable

Analysis:
* Head, names and summary functions were used to review the data
* Verified that aggregate returned total steps per day

```{r echo=TRUE}

# part 1: calculate sum, then create histogram 
# aggregate by date, then apply calculations
# source: https://www.statmethods.net/management/aggregate.html
steps_sum <- aggregate(steps ~ date, activity_omit, sum)

# verify results
# https://www.statmethods.net/stats/descriptives.html
head(steps_sum)
names(steps_sum)
summary(steps_sum)

# create histogram plot
# source: https://www.statmethods.net/graphs/density.html
hist(steps_sum$steps, col="green", 
     breaks=10, main="Total Steps per Day",
     xlab="Steps per Day", ylim=c(0,20), xlim=c(0,25000))

# part 2: calculate mean/median by date
# aggregate by date, then apply calculations
# source: https://www.statmethods.net/management/aggregate.html
steps_mean <- aggregate(steps ~ date, activity_omit, mean)

# verify results
# https://www.statmethods.net/stats/descriptives.html
head(steps_mean)
names(steps_mean)
summary(steps_mean)

# aggregate by date, then apply calculations
# source: https://www.statmethods.net/management/aggregate.html
steps_median <- aggregate(steps ~ date, activity_omit, median)

# verify results
# https://www.statmethods.net/stats/descriptives.html
head(steps_median)
names(steps_median)
summary(steps_median)

```


## What is the average daily activity pattern?

```{r echo=TRUE}

# part 1; group by interval, calculate mean and plot time series
# group by interval, then calculate mean steps for each group 
# source: https://datacarpentry.org/R-genomics/04-dplyr.html
library(dplyr)
steps_avg_interval <- activity_omit %>%
    group_by(interval) %>%
    summarize(steps_avg = mean(steps))

# verify results
# https://www.statmethods.net/stats/descriptives.html
head(steps_avg_interval)

# create time series plot; use date list and sum of steps
# source: https://www.datamentor.io/r-programming/plot-function/
plot(steps_avg_interval,
     main="Average Steps per Interval",
     xlab="Interval",
     ylab="Average Steps",
     col="blue",
     type="l")

# part 2: find interval with maximum steps across all days
# source: https://stackoverflow.com/questions/19449615/how-to-extract-the-row-with-min-or-max-values
max_interval <- steps_avg_interval[which.max(steps_avg_interval$steps_avg),]

# return row with max interval
max_interval


```


## Imputing missing values

```{r echo=TRUE}

# part 1: return count of rows with null values
# https://stackoverflow.com/questions/7980622/subset-of-rows-containing-na-missing-values-in-a-chosen-column-of-a-data-frame
activity_na <- activity[is.na(activity),]

# verify results
# https://www.statmethods.net/stats/descriptives.html
head(activity_na)
dim(activity_na)

# part 2-3: create new dataset with imputed null values 
# replace null with mean value by date
# source: https://datascience.stackexchange.com/questions/14065/imputing-missing-values-by-mean-by-id-column-in-r
activity_imp <- activity %>% 
    # group_by(date) %>% 
    mutate(steps=ifelse(is.na(steps),
                        mean(steps, na.rm=TRUE), steps))

# verify results
# https://www.statmethods.net/stats/descriptives.html
summary(activity_imp)
dim(activity_imp)
head(activity_imp)

# part 4: calculate sum, then create histogram 
# aggregate by date, then apply calculations
# source: https://www.statmethods.net/management/aggregate.html
steps_sum_imp <- aggregate(steps ~ date, activity_imp, sum)
summary(steps_sum_imp)

# create histogram plot
# source: https://www.statmethods.net/graphs/density.html
hist(steps_sum_imp$steps, col="blue", 
     breaks=10, main="Total Steps per Day (Imputed Values",
     xlab="Steps per Day", ylim=c(0,20), xlim=c(0,25000))

# part 2: calculate mean/median by date
# aggregate by date, then apply calculations
# source: https://www.statmethods.net/management/aggregate.html
steps_mean_imp <- aggregate(steps ~ date, activity_imp, mean)
summary(steps_mean)
summary(steps_mean_imp)

steps_median_imp <- aggregate(steps ~ date, activity_imp, median)
summary(steps_median)
summary(steps_median_imp)

```

## Are there differences in activity patterns between weekdays and weekends?

```{r echo=TRUE}

# part 1: create weekday/weekend factor within dataset

# first, create weekday/weekend categorical variable
# source: https://sphweb.bumc.bu.edu/otlt/MPH-Modules/BS/R/R-Manual/R-Manual4.html
activity_imp$wday_type <- ifelse(
    weekdays(as.Date(activity_imp$date)) == "Saturday" |
    weekdays(as.Date(activity_imp$date)) == "Sunday",
    "Weekend",
    "Weekday"
)
names(activity_imp)
unique(activity_imp$wday_type)

# part 2: create time series facet plot
# source: http://zevross.com/blog/2019/04/02/easy-multi-panel-plots-in-r-using-facet_wrap-and-facet_grid-from-ggplot2/
library(ggplot2)
ggplot(data=activity_imp, aes(interval, steps)) +
    geom_line(color="blue") +
    geom_point(color="blue") + 
    facet_wrap(~ wday_type)

```